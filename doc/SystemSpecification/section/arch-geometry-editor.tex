\subsection{Geometry editor}
\label{sec:arch-geometry}
\writer{Mikko}

The Geometry editor is the component used to define lines and points in a two dimensional plane which will then define the location and overall shape of the visualized simulation. Figure \ref{fig:model-geometry} describes the geometry model used by the Geometry Editor.

\begin{figure}[htp]
\begin{center}
  \includegraphics[width=0.8\textwidth]{image/geometry_diagram.png}
  \caption{Geometry domain model}
  \label{fig:model-geometry}
\end{center}
\end{figure}

\paragraph{Geometry}
The Geometry class is an abstract definition of a geometry object.

\paragraph{GObject}
The GObject is a geometry object, which can be either a line or a point. It has attribute \textbf{name}. It is used to name individual geometry objects, so that user can easily tell them apart. Furthermore, it is used as an identifier for all geometry objects.

\paragraph{Point}
Point is a location in the two dimensional plane. It has attributes \textbf{xLocation} and \textbf{yLocation} which refer to the horizontal and vertical coordinates respectively.

\paragraph{InputPoint}
Class InputPoint refers to objects that will be clickable for the user in the 3D simulation. The\textbf{AppearanceLabel} attribute is used to identify the 3D appearance of an InputPoint, such as traffic light, tree, planet etc, within the simulation.

\paragraph{Connector}
Class Connector is either the beginning or the ending parametric point of a line. Therefore, lines that end at a Connector are \textbf{in} and lines that start from a Connector are \textbf{out}.

\paragraph{BendPoint}
Class BendPoint is the type of parametric point that defines the curvature of the line.

\paragraph{Line}
Class Line is a parametric curve in the two dimensional plane. The line begins at a point location \textbf{begin} and it ends at a point location \textbf{end}. A \textbf{BendPoint} is a point location which defines in a parametric way the curvature of the line, unless it doesn't have one, thus the line would be straight. The\textbf{AppearanceLabel} attribute is used to define the 3D shape of the line within the simulation. The appearance will be extrapolated along the length of the line, thus the appearance could for instance be track, road, empty space, etc. On the other hand, the \textbf{tokenAppearanceLabel} attribute defines 3D models that are animated along the line. They could be for instance train, bike, space ship, etc.

The geometry editor is initially implemented with Graphical Modeling Framework (GMF). It provides the factory pattern for construction of objects, command pattern for the editing functionality and interfaces for function calls. The implementation is then extended with listeners. The listener notifies the geometry of the changes done to the location of a graphical object in the graphical editor. This information is used to define coordinate locations of geometry objects. Furthermore, the visualization of lines, or as they are called in GMF- connections, in the graphical editor is changed to that of catmull-rom curves. 





